---
title: "RQ2 Linear Regression"
author: "Shiya"
date: "Nov 18, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
setwd("C:/Users/Shiya/Desktop/PIAAC/2_Regression/2.1_Linear Regression")
load("C:/Users/Shiya/Desktop/PIAAC/2_Regression/2.1_Linear Regression/.RData")
```

## RQ2-b.
### Build linear regression models to investigate the extent skills used at work are associated with full-time professionals' PS-TRE proficiency scores.

PS-TRE Model 1.0: Socio-Demographic Background (Overall)
```{r}
dat.all$GENDER<-as.factor(dat.all$GENDER)
dat.all$AGE10BAND<-as.factor(dat.all$AGE10BAND)
dat.all$PARED<-as.factor(dat.all$PARED)
dat.all$EDU<-as.factor(dat.all$EDU)

PSL.lm1.0<-lm(dat.all$mean.PSL10~GENDER+AGE10BAND+PARED+EDU,data=dat.all)
PSL.lm1.0
summary(PSL.lm1.0)

if(!("sjPlot" %in% installed.packages()[,1])) {
 install.packages("sjPlot")
 }
library(sjPlot)

sjp.lm(PSL.lm1.0,type="coef")
```

PS-TRE Model 1: Socio-Demographic Background (By Country)
```{r}
if(!("lme4" %in% installed.packages()[,1])) {
 install.packages("lme4")
 }
library(lme4)

PSL.lm1<-lmList(mean.PSL10~GENDER+AGE10BAND+PARED+EDU| CNTRYID, data=dat.all)
PSL.lm1
sapply(PSL.lm1,function(x) summary(x)$r.squared)
```


PS-TRE Model 2.0: Socio-Demographic Background + Occupational Categories (Overall)
```{r}
dat.all$Sector<-as.factor(dat.all$Sector)
dat.all$Role<-as.factor(dat.all$Role)
dat.all$ISCO2C<-as.factor(dat.all$ISCO2C)

PSL.lm2.0<-lm(dat.all$mean.PSL10~GENDER+AGE10BAND+PARED+EDU +ISCO2C,data=dat.all)
PSL.lm2.0
summary(PSL.lm2.0)

library(sjPlot)
sjp.lm(PSL.lm2.0,type="coef")
```

PS-TRE Model 2: Socio-Demographic Background + Job Characteristics (By Country)
```{r}
library(lme4)
PSL.lm2<-lmList(mean.PSL10 ~ GENDER+AGE10BAND+PARED+EDU +ISCO2C | CNTRYID, data=dat.all)
PSL.lm2
sapply(PSL.lm2,function(x) summary(x)$r.squared)
```


PS-TRE Model 3.0: Socio-Demographic Background + Occupational Categories + Info-Processing Skills USE (Overall)
```{r}
PSL.lm3.0<-lm(dat.all$mean.PSL10~GENDER+AGE10BAND+PARED+EDU +ISCO2C +READWORK+WRITWORK+NUMWORK+ICTWORK,data=dat.all)
PSL.lm3.0
summary(PSL.lm3.0)

library(sjPlot)
sjp.lm(PSL.lm3.0,type="coef")
```

PS-TRE Model 3: Socio-Demographic Background + Job Characteristics + Info-Processing Skills USE (By Country)
```{r}
library(lme4)
PSL.lm3<-lmList(mean.PSL10 ~ GENDER+AGE10BAND+PARED+EDU +ISCO2C +READWORK+WRITWORK+NUMWORK+ICTWORK | CNTRYID, data=dat.all)
PSL.lm3
sapply(PSL.lm3,function(x) summary(x)$r.squared)
```


PS-TRE Model 4.0: Socio-Demographic Background + Job Characteristics + Info-Processing Skills USE + Workplace Skills USE (Overall)
```{r}
PSL.lm4.0<-lm(dat.all$mean.PSL10~GENDER+AGE10BAND+PARED+EDU +ISCO2C +READWORK+WRITWORK+NUMWORK+ICTWORK + INFLUENCE+PLANNING+TASKDISC+LEARNATWORK,data=dat.all)
PSL.lm4.0
summary(PSL.lm4.0)

library(sjPlot)
sjp.lm(PSL.lm4.0,type="coef")
```

PS-TRE Model 4: Socio-Demographic Background + Job Characteristics + Info-Processing Skills USE + Workplace Skills USE (By Country)
```{r}
library(lme4)
PSL.lm4<-lmList(mean.PSL10 ~ GENDER+AGE10BAND+PARED+EDU +ISCO2C +READWORK+WRITWORK+NUMWORK+ICTWORK +INFLUENCE+PLANNING+TASKDISC+LEARNATWORK | CNTRYID, data=dat.all)
PSL.lm4

sapply(PSL.lm4,function(x) summary(x)$r.squared)
```


PS-TRE Model 5.0: Socio-Demographic Background + Job Characteristics + Info-Processing Skills USE + Workplace Skills USE + AET Participation (Overall)
```{r}
dat.all$AET_Par<-as.factor(dat.all$AET_Par)

PSL.lm5.0<-lm(dat.all$mean.PSL10~GENDER+AGE10BAND+PARED+EDU +ISCO2C +READWORK+WRITWORK+NUMWORK+ICTWORK +INFLUENCE+PLANNING+TASKDISC+LEARNATWORK +AET_Par,data=dat.all)
PSL.lm5.0
summary(PSL.lm5.0)

library(sjPlot)
sjp.lm(PSL.lm5.0,type="coef")
```

PS-TRE Model 5: Socio-Demographic Background + Job Characteristics + Info-Processing Skills USE + Workplace Skills USE + AET Participation (By Country)
```{r}
library(lme4)
PSL.lm5<-lmList(mean.PSL10 ~ GENDER+AGE10BAND+PARED+EDU +ISCO2C +READWORK+WRITWORK+NUMWORK+ICTWORK +INFLUENCE+PLANNING+TASKDISC+LEARNATWORK +AET_Par| CNTRYID, data=dat.all)
PSL.lm5
sapply(PSL.lm5,function(x) summary(x)$r.squared)
```



